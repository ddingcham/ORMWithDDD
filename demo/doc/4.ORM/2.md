# [Domain-Driven Design의 적용 - 4.ORM과 투명한 영속성 2부](http://aeternum.egloos.com/1380433)

## ENTITY : aliasing - REFERENCE OBJECT  
#### REFERENCE OBJECT의 기술적인 측면을 캡슐화하고 도메인 측면만을 추상화  
#### ENTITY라는 용어는 광범위한 구현 기술을 수용 (REFERENCE OBJECT:객체 지향 언어 한정)

### REFERENCE OBJECT의 두 측면  
* 의미론적 측면 // 본질적인(essential) 특성  
  * 도메인의 특성  
  * 도메인 개념의 **유일성과 추적성**  
  * REPOSITORY, AGGREGATE와 같은 다른 도메인 요소에 영향을 미침  

* 기술론적 측면 // 비본질적인(accidental) 특성  
  * 언어 자체의 특성  
  * 생성 시 메모리 주소를 기반으로 한 식별자를 할당  
  * ex) "==" 연산자를 사용한 객체의 동일성 판단  

* 측면 간 충돌
#### 본질적인 특성은 변하지 않지만, 비본질적인 특성은 언어, 환경, 기술에 따라 영향을 받는다.  
#### REFERENCE OBJECT란 용어를 어떤 측면으로 다루느냐에 따라 오해 발생 소지가 있음  
#### 소프트웨어 개발의 복잡성은 본질적인 특성에 기인한 것이지 비본질적인 특성에 기인한 것이 아니다. _ Fredy Brooks
> 소프트웨어 문제의 본질을 다루는 도전, 즉 복잡한 개념적 구조를 체계화하는 것을 우선적으로 고려해야 한다.  

### ENTITY의 개념  
* 기본적인 개념은 REFERENCE OBJECT와 동일  
* **식별자**(identity)를 가지고 **추적가능**하며 **연속성**을 가지는 도메인 개념  
* ENTITY는 속성이 아닌 **식별자**(identity)로 구분된다.  
  > VALUE OBJECT(속성이 될)  
  > * 식별자가 아닌 속성으로 구별  
  > * 생명주기가 ENTITY에 종속  
  
* ENTITY는 도메인 내에 존재하는 개념의 연속성을 강조  
  > 단순히 시스템 내에 존재하는 객체만을 지칭하지 않는다.  
  > 표현 매체의 특성이나 기술에 독립적이다. // UBIQUITOUS LANGUAGE  

### ENTITY의 본질
```
고객의 신규 가입을 처리하기 위해 시스템은 고객 정보를 상태로 가지는 객체를 생성한다.
생성된 고객 객체는 비즈니스 로직을 처리하기 위해 사용된 후 영구 저장소에 보관된다.

대부분의 경우 영구 저장소로 관계형 데이터베이스를 사용할 것이며 
고객 객체는 데이터베이스 테이블의 한 레코드로 저장될 것이다. 

시스템은 다시 고객 정보가 필요한 경우 데이터베이스로부터 레코드를 읽어 
고객 객체의 상태를 복원하고 비즈니스 로직을 처리한 후 변경된 상태를 다시 데이터베이스에 저장한다. 

시스템은 주기적으로 고객 정보를 공유하는 제3의 시스템에 해당 고객 정보를 전송해야 할 수도 있다. 
시스템은 고객 정보를 바이트 스트림으로 변경한 후 네트워크를 통해 다른 시스템에 전송한다. 

고객 정보를 수신한 시스템은 다시 바이트 스트림을 고객 객체로 복원하고 
비즈니스 로직을 처리한 후 적합한 데이터베이스에 저장한다.
```
#### 다양한 형태의 신규 가입 고객의 정보  
(객체, 데이터베이스 레코드, 네트워크 전송을 위한 바이트 스트림,  
타 시스템 내의 객체, 타 시스템 내의 데이터베이스 레코드)  
> 형태와 무관하게 한가지 동일한 속성 공유  

#### ENTITY의 본질 : 도메인 내의 존재하는 동일한 고객의 상태를 표현  

### 결론  
#### ENTITY는 도메인 객체의 표현 형태를 초월해서 **동일한 도메인 개념의 추적성과 유일성** 강조  
  > 메모리 상의 고객 객체와 데이터베이스에 저장된 고객 테이블의 레코드를 동일한 대상화  
  > 시스템에 무관하게 연속적인 추적성을 갖는다.  
  
#### ENTITY라는 용어는 도메인 개념의 연속성과 생명 주기를 구현 기술에 독립적인 문맥 상에서 이해할 수 있도록 한다.
  > REFERENCE OBJECT라는 용어를 사용하지 않음으로써  
  > 도메인 객체의 생명주기와 객체(기술적) 생명주기 간 혼동을 막는다.  
  
ENTITY가 REFERENCE OBJECT를 표현 형태와 기술에 독립적인 개념으로 확장한다면,  
REFERENCE OBJECT의 생명 주기와 식별자의 의미는 어떻게 될 것인가?
